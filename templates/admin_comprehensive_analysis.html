{% extends "base.html" %}
{% block title %}åŒ…æ‹¬çš„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åˆ†æ - {{ app_name }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>ğŸ” åŒ…æ‹¬çš„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åˆ†æ</h2>
    
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">æ¨å®šãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º</h5>
                    <h3 class="text-primary">{{ analysis.estimated_db_total_mb }}MB</h3>
                    <small class="text-muted">ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰è¾¼ã¿ï¼‰</small>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">Renderå®Ÿéš›ã®ä½¿ç”¨é‡</h5>
                    <h3 class="text-warning">{{ analysis.render_usage_mb }}MB</h3>
                    <small class="text-muted">ï¼ˆ8.36% of 1GBï¼‰</small>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">å·®åˆ†</h5>
                    <h3 class="{% if analysis.difference_mb > 50 %}text-danger{% else %}text-info{% endif %}">
                        {{ analysis.difference_mb }}MB
                    </h3>
                    <small class="text-muted">ï¼ˆã‚¢ãƒ—ãƒªæœ¬ä½“ãªã©ï¼‰</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥è©³ç´° -->
    <div class="card mb-4">
        <div class="card-header">
            <h4>ğŸ“Š ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º</h4>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
                            <th>ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°</th>
                            <th>ã‚µã‚¤ã‚º</th>
                            <th>è©³ç´°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼</strong></td>
                            <td>{{ analysis.table_analysis.users.count }}</td>
                            <td>{{ analysis.table_analysis.users.total_size_mb }}MB</td>
                            <td>
                                å¹³å‡: {{ analysis.table_analysis.users.avg_size_kb }}KB/äºº<br>
                                æœ€å¤§: {{ analysis.table_analysis.users.max_user }} ({{ analysis.table_analysis.users.max_size_kb }}KB)
                            </td>
                        </tr>
                        <tr>
                            <td><strong>CSVãƒ•ã‚¡ã‚¤ãƒ«</strong></td>
                            <td>{{ analysis.table_analysis.csv_files.count }}</td>
                            <td>{{ analysis.table_analysis.csv_files.total_size_mb }}MB</td>
                            <td>
                                {% for file in analysis.table_analysis.csv_files.files %}
                                {{ file.filename }}: {{ file.size_kb }}KB<br>
                                {% endfor %}
                            </td>
                        </tr>
                        <tr>
                            <td><strong>éƒ¨å±‹è¨­å®š</strong></td>
                            <td>{{ analysis.table_analysis.room_settings.count }}</td>
                            <td>{{ analysis.table_analysis.room_settings.total_size_kb }}KB</td>
                            <td>è¨­å®šãƒ‡ãƒ¼ã‚¿</td>
                        </tr>
                        <tr>
                            <td><strong>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒˆãƒ¼ã‚¯ãƒ³</strong></td>
                            <td>{{ analysis.table_analysis.password_tokens.count }}</td>
                            <td>{{ analysis.table_analysis.password_tokens.total_size_kb }}KB</td>
                            <td>ä¸€æ™‚çš„ãªãƒˆãƒ¼ã‚¯ãƒ³</td>
                        </tr>
                        <tr>
                            <td><strong>ã‚¢ãƒ—ãƒªæƒ…å ±</strong></td>
                            <td>{{ analysis.table_analysis.app_info.count }}</td>
                            <td>{{ analysis.table_analysis.app_info.total_size_kb }}KB</td>
                            <td>ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿</td>
                        </tr>
                        <tr>
                            <td><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼çµ±è¨ˆ</strong></td>
                            <td>{{ analysis.table_analysis.user_stats.count }}</td>
                            <td>{{ analysis.table_analysis.user_stats.total_size_kb }}KB</td>
                            <td>çµ±è¨ˆãƒ‡ãƒ¼ã‚¿</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- å·®åˆ†ã®èª¬æ˜ -->
    <div class="card mb-4">
        <div class="card-header">
            <h4>ğŸ¤” {{ analysis.difference_mb }}MBã®å·®åˆ†ã®æ­£ä½“</h4>
        </div>
        <div class="card-body">
            <p>æ¨å®šãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã¨å®Ÿéš›ã®ä½¿ç”¨é‡ã«å·®ãŒã‚ã‚‹ç†ç”±ï¼š</p>
            <ul>
                <li><strong>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“:</strong> Pythonå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆFlaskã€SQLAlchemyç­‰ï¼‰</li>
                <li><strong>Static/Templatesãƒ•ã‚¡ã‚¤ãƒ«:</strong> CSSã€JavaScriptã€HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</li>
                <li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰:</strong> ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€WALãƒ­ã‚°</li>
                <li><strong>ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«:</strong> ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã€ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥</li>
                <li><strong>Renderãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ :</strong> å®Ÿè¡Œç’°å¢ƒã€ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ãªã©</li>
            </ul>
            
            {% if analysis.difference_mb > 70 %}
            <div class="alert alert-warning">
                <strong>âš ï¸ æ³¨æ„:</strong> å·®åˆ†ãŒ70MBä»¥ä¸Šã§ã™ã€‚ã‚¢ãƒ—ãƒªæœ¬ä½“ãŒå¤§ãããªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
            </div>
            {% else %}
            <div class="alert alert-success">
                <strong>âœ… æ­£å¸¸:</strong> å·®åˆ†ã¯æ­£å¸¸ç¯„å›²å†…ã§ã™ã€‚
            </div>
            {% endif %}
        </div>
    </div>
    
    <div class="text-center">
        <a href="{{ url_for('admin_page') }}" class="btn btn-secondary">â† ç®¡ç†è€…ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
        <button type="button" onclick="location.reload()" class="btn btn-outline-info">ğŸ”„ å†åˆ†æ</button>
        <button type="button" onclick="window.print()" class="btn btn-outline-primary">ğŸ–¨ï¸ åˆ†æçµæœã‚’å°åˆ·</button>
    </div>
</div>
{% endblock %}