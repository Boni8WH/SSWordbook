{% extends "base.html" %}
{% block title %}ã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦ - {{ app_name }}{% endblock %}

{% block content %}
<section class="score-details-section">
    <div class="header-section">
        <h2>ğŸ“ ã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦</h2>
        <p class="subtitle">ä¿¡é ¼æ€§é‡è¦–ã®ç·åˆå­¦ç¿’è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°</p>
        <div class="back-link">
            <a href="{{ url_for('progress_page') }}" class="btn btn-outline-primary btn-sm">
                <i class="fas fa-arrow-left"></i> é€²æ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
            </a>
        </div>
    </div>

    <!-- åŸºæœ¬å¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="formula-container">
        <h3>ğŸ”¢ åŸºæœ¬å¼</h3>
        <div class="formula-box">
            <div class="formula-main">
                ç·åˆã‚¹ã‚³ã‚¢ = <span class="condition">{ 0 (å›ç­”æ•° = 0ã®å ´åˆ) | (A + B + C) Ã· 100 (å›ç­”æ•° > 0ã®å ´åˆ) }</span>
            </div>
        </div>
    </div>

    <!-- å„è¦ç´ ã®è©³ç´° -->
    <div class="components-section">
        <h3>ğŸ“Š å„è¦ç´ ã®è¨ˆç®—</h3>
        
        <!-- A. ãƒã‚¹ã‚¿ãƒ¼æ•°è©•ä¾¡ -->
        <div class="component-card mastery-card">
            <div class="component-header">
                <h4><span class="component-label">A</span> ãƒã‚¹ã‚¿ãƒ¼æ•°è©•ä¾¡</h4>
                <span class="weight-badge">æœ€é‡è¦</span>
            </div>
            <div class="formula-detail">
                <code>A = (ãƒã‚¹ã‚¿ãƒ¼æ•°)<sup>1.3</sup> Ã— 10</code>
            </div>
            <ul class="explanation-list">
                <li><strong>ãƒã‚¹ã‚¿ãƒ¼æ•°</strong> = æ­£ç­”ç‡80%ä»¥ä¸Šã®å•é¡Œæ•°</li>
                <li><strong>1.3ä¹—</strong>ã«ã‚ˆã‚Šã€å¤šããƒã‚¹ã‚¿ãƒ¼ã™ã‚‹ã»ã©æŒ‡æ•°çš„ã«é«˜è©•ä¾¡</li>
                <li><strong>ç‹™ã„</strong>ï¼šæ·±ã„ç†è§£ã¨å®šç€ã‚’æœ€é‡è¦–</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> 15å•ãƒã‚¹ã‚¿ãƒ¼ â†’ 15<sup>1.3</sup> Ã— 10 = <strong>274ãƒã‚¤ãƒ³ãƒˆ</strong>
            </div>
        </div>

        <!-- B. ä¿¡é ¼æ€§è£œæ­£æ¸ˆã¿æ­£ç­”ç‡è©•ä¾¡ -->
        <div class="component-card accuracy-card">
            <div class="component-header">
                <h4><span class="component-label">B</span> ä¿¡é ¼æ€§è£œæ­£æ¸ˆã¿æ­£ç­”ç‡è©•ä¾¡</h4>
                <span class="feature-badge">çµ±è¨ˆè£œæ­£</span>
            </div>
            <div class="formula-detail">
                <code>è£œæ­£æ­£ç­”ç‡ = (7 + å®Ÿéš›ã®æ­£è§£æ•°) Ã· (10 + å®Ÿéš›ã®å›ç­”æ•°)</code><br>
                <code>B = (è£œæ­£æ­£ç­”ç‡)<sup>2</sup> Ã— 500</code>
            </div>
            <ul class="explanation-list">
                <li><strong>ãƒ™ã‚¤ã‚ºçµ±è¨ˆ</strong>ã«ã‚ˆã‚‹ä¿¡é ¼æ€§è£œæ­£ã‚’é©ç”¨</li>
                <li>å›ç­”æ•°ãŒå°‘ãªã„å ´åˆã€æƒ³å®šæ­£ç­”ç‡70%ã«å¼•ã£å¼µã‚‰ã‚Œã‚‹</li>
                <li><strong>2ä¹—</strong>ã«ã‚ˆã‚Šé«˜æ­£ç­”ç‡ã«å¤§ããªå ±é…¬</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> 80/100å›æ­£è§£ â†’ ((7+80)Ã·(10+100))<sup>2</sup> Ã— 500 = <strong>312ãƒã‚¤ãƒ³ãƒˆ</strong>
            </div>
        </div>

        <!-- C. å­¦ç¿’é‡è©•ä¾¡ -->
        <div class="component-card effort-card">
            <div class="component-header">
                <h4><span class="component-label">C</span> å­¦ç¿’é‡è©•ä¾¡</h4>
                <span class="balance-badge">é©åº¦ãªè©•ä¾¡</span>
            </div>
            <div class="formula-detail">
                <code>C = ln(å›ç­”æ•° + 1) Ã— 20</code>
            </div>
            <ul class="explanation-list">
                <li><strong>è‡ªç„¶å¯¾æ•°</strong>ã«ã‚ˆã‚Šã€åŠªåŠ›ã™ã‚‹ã»ã©ä¼¸ã³ã‚‹ãŒéåº¦ãªå„ªé‡ãªã—</li>
                <li>å¤§é‡å›ç­”ã«ã‚ˆã‚‹åŠ›æŠ€ã‚’é©åˆ‡ã«æŠ‘åˆ¶</li>
                <li>ç¶™ç¶šçš„ãªå­¦ç¿’ã‚’é©åº¦ã«è©•ä¾¡</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> 100å›ç­” â†’ ln(101) Ã— 20 = <strong>92ãƒã‚¤ãƒ³ãƒˆ</strong>
            </div>
        </div>
    </div>

    <!-- å…·ä½“ä¾‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="example-section">
        <h3>ğŸ¯ å…·ä½“çš„ãªè¨ˆç®—ä¾‹</h3>
        <div class="calculation-example">
            <div class="example-title">ãƒã‚¹ã‚¿ãƒ¼15å•ã€æ­£è§£80å›/100å›ç­”ã®å­¦ç¿’è€…ã®å ´åˆ</div>
            <div class="calculation-steps">
                <div class="step">
                    <span class="step-label">A</span>
                    <span class="step-calc">15<sup>1.3</sup> Ã— 10 = <strong>274ãƒã‚¤ãƒ³ãƒˆ</strong></span>
                </div>
                <div class="step">
                    <span class="step-label">B</span>
                    <span class="step-calc">((7+80)Ã·(10+100))<sup>2</sup> Ã— 500 = 0.79<sup>2</sup> Ã— 500 = <strong>312ãƒã‚¤ãƒ³ãƒˆ</strong></span>
                </div>
                <div class="step">
                    <span class="step-label">C</span>
                    <span class="step-calc">ln(101) Ã— 20 = <strong>92ãƒã‚¤ãƒ³ãƒˆ</strong></span>
                </div>
                <div class="final-result">
                    <span class="result-label">ç·åˆã‚¹ã‚³ã‚¢</span>
                    <span class="result-calc">(274 + 312 + 92) Ã· 100 = <strong>6.78ãƒã‚¤ãƒ³ãƒˆ</strong></span>
                </div>
            </div>
        </div>
    </div>

    <!-- è¨­è¨ˆæ€æƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="philosophy-section">
        <h3>âš–ï¸ è¨­è¨ˆæ€æƒ³</h3>
        <div class="philosophy-content">
            <p class="philosophy-main">
                è³ªã®é«˜ã„å­¦ç¿’ï¼ˆç†è§£+å®šç€ï¼‰ã‚’çµ±è¨ˆçš„ä¿¡é ¼æ€§ã¨ã¨ã‚‚ã«è©•ä¾¡ã—ã€
                ã€Œå°‘æ•°å›ç­”ã§ã®å¶ç„¶é«˜å¾—ç‚¹ã€ã‚„ã€Œå¤§é‡å›ç­”ã§ã®åŠ›æŠ€ã€ã‚’é©åˆ‡ã«è£œæ­£ã™ã‚‹å…¬å¹³ãªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
            </p>
            <div class="fairness-features">
                <div class="feature-item">
                    <i class="fas fa-shield-alt text-success"></i>
                    <span>å°‘ãªã„å›ç­”æ•°ã§ã®é«˜æ­£ç­”ç‡ã¯çµ±è¨ˆçš„ã«è£œæ­£</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-balance-scale text-warning"></i>
                    <span>å¤§é‡å›ç­”ã§ã‚‚ä½æ­£ç­”ç‡ã§ã¯é«˜ã‚¹ã‚³ã‚¢ã«ãªã‚‰ãªã„</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-trophy text-primary"></i>
                    <span>çœŸã®ç†è§£ã¨å®šç€ã‚’æœ€ã‚‚é«˜ãè©•ä¾¡</span>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¯”è¼ƒè¡¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="comparison-section">
        <h3>ğŸ“‹ å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥ã‚¹ã‚³ã‚¢æ¯”è¼ƒ</h3>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
                        <th>ãƒã‚¹ã‚¿ãƒ¼æ•°</th>
                        <th>æ­£è§£/å›ç­”</th>
                        <th>å®Ÿæ­£ç­”ç‡</th>
                        <th>è£œæ­£æ­£ç­”ç‡</th>
                        <th>ç·åˆã‚¹ã‚³ã‚¢</th>
                        <th>è©•ä¾¡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-success">
                        <td>è³ªé‡è¦–å‹</td>
                        <td>25å•</td>
                        <td>90/100</td>
                        <td>90%</td>
                        <td>89%</td>
                        <td><strong>10.2</strong></td>
                        <td>å„ªç§€</td>
                    </tr>
                    <tr class="table-info">
                        <td>ãƒãƒ©ãƒ³ã‚¹å‹</td>
                        <td>15å•</td>
                        <td>80/100</td>
                        <td>80%</td>
                        <td>79%</td>
                        <td><strong>6.8</strong></td>
                        <td>è‰¯å¥½</td>
                    </tr>
                    <tr class="table-warning">
                        <td>é‡é‡è¦–å‹</td>
                        <td>10å•</td>
                        <td>120/200</td>
                        <td>60%</td>
                        <td>61%</td>
                        <td><strong>4.1</strong></td>
                        <td>è¦æ”¹å–„</td>
                    </tr>
                    <tr class="table-secondary">
                        <td>å°‘æ•°é«˜å¾—ç‚¹</td>
                        <td>2å•</td>
                        <td>10/10</td>
                        <td>100%</td>
                        <td>85%</td>
                        <td><strong>3.6</strong></td>
                        <td>è£œæ­£æ¸ˆã¿</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="back-section">
        <a href="{{ url_for('progress_page') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left"></i> é€²æ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
        </a>
    </div>
</section>

<style>
.score-details-section {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
}

.header-section {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 3px solid #007bff;
}

.subtitle {
    color: #6c757d;
    font-size: 1.1rem;
    margin-bottom: 15px;
}

.back-link {
    margin-top: 15px;
}

.formula-container {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 30px;
    border-left: 5px solid #007bff;
}

.formula-box {
    text-align: center;
}

.formula-main {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2c3e50;
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.condition {
    color: #007bff;
}

.components-section {
    margin-bottom: 30px;
}

.component-card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    border-left: 5px solid;
}

.mastery-card { border-left-color: #28a745; }
.accuracy-card { border-left-color: #ffc107; }
.effort-card { border-left-color: #17a2b8; }

.component-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.component-label {
    background: #007bff;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: bold;
    margin-right: 10px;
}

.weight-badge { background: #28a745; }
.feature-badge { background: #ffc107; color: #000; }
.balance-badge { background: #17a2b8; }

.weight-badge, .feature-badge, .balance-badge {
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

.formula-detail {
    background: #f8f9fa;
    padding: 10px 15px;
    border-radius: 6px;
    margin-bottom: 15px;
    font-family: 'Courier New', monospace;
    border: 1px solid #dee2e6;
}

.explanation-list {
    margin-bottom: 15px;
    padding-left: 20px;
}

.explanation-list li {
    margin-bottom: 5px;
    color: #495057;
}

.example-box {
    background: #e7f3ff;
    padding: 10px 15px;
    border-radius: 6px;
    border: 1px solid #b8daff;
    color: #004085;
}

.example-section {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 30px;
}

.calculation-example {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.example-title {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 20px;
    text-align: center;
    font-size: 1.1rem;
}

.calculation-steps {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.step {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 6px;
}

.step-label {
    background: #007bff;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: bold;
    min-width: 25px;
    text-align: center;
}

.final-result {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    border-radius: 6px;
    font-weight: 600;
    margin-top: 10px;
}

.result-label {
    background: rgba(255,255,255,0.2);
    padding: 4px 8px;
    border-radius: 4px;
    min-width: 80px;
    text-align: center;
}

.philosophy-section {
    background: linear-gradient(135deg, #6f42c1, #007bff);
    color: white;
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 30px;
}

.philosophy-main {
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 20px;
    text-align: center;
}

.fairness-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
}

.feature-item {
    display: flex;
    align-items: center;
    gap: 10px;
    background: rgba(255,255,255,0.1);
    padding: 12px;
    border-radius: 6px;
}

.comparison-section {
    margin-bottom: 30px;
}

.back-section {
    text-align: center;
    padding-top: 20px;
    border-top: 2px solid #e9ecef;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
@media (max-width: 768px) {
    .score-details-section {
        padding: 15px;
    }
    
    .component-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
    
    .step {
        flex-direction: column;
        align-items: flex-start;
        text-align: left;
    }
    
    .final-result {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .fairness-features {
        grid-template-columns: 1fr;
    }
    
    .formula-main {
        font-size: 1rem;
        line-height: 1.4;
    }
}
</style>
{% endblock %}