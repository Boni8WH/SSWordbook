{% extends "base.html" %}
{% block title %}ã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦ - {{ app_name }}{% endblock %}

{% block content %}
<section class="score-details-section">
    <div class="header-section">
        <h2>ğŸ“ ã‚¹ã‚³ã‚¢ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦</h2>
        <p class="subtitle">ä¿¡é ¼æ€§é‡è¦–ã®ç·åˆå­¦ç¿’è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°</p>
        <div class="back-link">
            <a href="{{ url_for('progress_page') }}" class="btn btn-outline-primary btn-sm">
                <i class="fas fa-arrow-left"></i> é€²æ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
            </a>
        </div>
    </div>

    <!-- åŸºæœ¬å¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="formula-container">
        <h3>ğŸ”¢ åŸºæœ¬å¼</h3>
        <div class="formula-box">
            <div class="formula-main">
                ç·åˆã‚¹ã‚³ã‚¢ = <span class="condition">ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚³ã‚¢ + æ­£ç­”ç‡ã‚¹ã‚³ã‚¢ + ç¶™ç¶šæ€§ã‚¹ã‚³ã‚¢ + ç²¾åº¦ãƒœãƒ¼ãƒŠã‚¹</span>
            </div>
        </div>
    </div>

    <!-- å„è¦ç´ ã®è©³ç´° -->
    <div class="components-section">
        <h3>ğŸ“Š å„è¦ç´ ã®è¨ˆç®—</h3>

        <!-- 1. ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚³ã‚¢ -->
        <div class="component-card mastery-card">
            <div class="component-header">
                <h4><span class="component-label">1</span> ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚³ã‚¢ï¼ˆæ®µéšçš„è©•ä¾¡ï¼‰</h4>
                <span class="weight-badge">æ®µéšå¼</span>
            </div>
            <div class="formula-detail">
                <code>ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚³ã‚¢ = floor(ãƒã‚¹ã‚¿ãƒ¼æ•° Ã· 100) Ã— 250 + (ãƒã‚¹ã‚¿ãƒ¼æ•° % 100 Ã· 100) Ã— 125</code>
            </div>
            <ul class="explanation-list">
                <li><strong>ãƒã‚¹ã‚¿ãƒ¼æ•°</strong> = æ­£ç­”ç‡80%ä»¥ä¸Šã®å•é¡Œæ•°</li>
                <li><strong>æ®µéšè©•ä¾¡</strong>ï¼š100å•é”æˆã”ã¨ã«250ç‚¹ã®å¤§å¹…ã‚¢ãƒƒãƒ—</li>
                <li><strong>é€£ç¶šè©•ä¾¡</strong>ï¼šé€”ä¸­é€²æ—ã‚‚125ç‚¹æº€ç‚¹ã§è©•ä¾¡</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> 350å•ãƒã‚¹ã‚¿ãƒ¼ â†’ floor(350Ã·100)Ã—250 + (50Ã·100)Ã—125 = 750 + 62.5 = <strong>812.5ç‚¹</strong>
            </div>
        </div>

        <!-- 2. æ­£ç­”ç‡ã‚¹ã‚³ã‚¢ -->
        <div class="component-card accuracy-card">
            <div class="component-header">
                <h4><span class="component-label">2</span> æ­£ç­”ç‡ã‚¹ã‚³ã‚¢ï¼ˆæ®µéšçš„é€£ç¶šè¨ˆç®—ï¼‰</h4>
                <span class="feature-badge">æ€¥ä¸Šæ˜‡å¼</span>
            </div>
            <div class="formula-detail">
                <code>90%ä»¥ä¸Š: 500 + (æ­£ç­”ç‡ - 0.9) Ã— 800</code><br>
                <code>80-89%: 350 + (æ­£ç­”ç‡ - 0.8) Ã— 1500</code><br>
                <code>70-79%: 200 + (æ­£ç­”ç‡ - 0.7) Ã— 1500</code><br>
                <code>60-69%: 100 + (æ­£ç­”ç‡ - 0.6) Ã— 1000</code><br>
                <code>60%æœªæº€: æ­£ç­”ç‡ Ã— 166.67</code>
            </div>
            <ul class="explanation-list">
                <li><strong>æ®µéšè¨­å®š</strong>ï¼šæ­£ç­”ç‡ã®åŒºé–“ã”ã¨ã«ç•°ãªã‚‹å‚¾æ–œ</li>
                <li><strong>80%ã®å£</strong>ï¼š80%ä»¥ä¸Šã§å¤§å¹…ã‚¹ã‚³ã‚¢ã‚¢ãƒƒãƒ—</li>
                <li><strong>é€£ç¶šè¨ˆç®—</strong>ï¼šåŒºé–“å†…ã§ã‚‚ç´°ã‹ãè©•ä¾¡</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> æ­£ç­”ç‡85% â†’ 350 + (0.85 - 0.8) Ã— 1500 = 350 + 75 = <strong>425ç‚¹</strong>
            </div>
        </div>

        <!-- 3. ç¶™ç¶šæ€§ã‚¹ã‚³ã‚¢ -->
        <div class="component-card effort-card">
            <div class="component-header">
                <h4><span class="component-label">3</span> ç¶™ç¶šæ€§ã‚¹ã‚³ã‚¢ï¼ˆæ´»å‹•é‡è©•ä¾¡ï¼‰</h4>
                <span class="balance-badge">ç©ã¿ä¸Šã’å¼</span>
            </div>
            <div class="formula-detail">
                <code>ç¶™ç¶šæ€§ã‚¹ã‚³ã‚¢ = âˆš(ç·å›ç­”æ•°) Ã— 3</code>
            </div>
            <ul class="explanation-list">
                <li><strong>å¹³æ–¹æ ¹é–¢æ•°</strong>ï¼šå›ç­”æ•°ãŒå¢—ãˆã‚‹ã»ã©ç·©ã‚„ã‹ã«ä¸Šæ˜‡</li>
                <li><strong>ç¶™ç¶šé‡è¦–</strong>ï¼šã‚³ãƒ„ã‚³ãƒ„å­¦ç¿’ã‚’ç€å®Ÿã«è©•ä¾¡</li>
                <li><strong>é©åº¦ãªè©•ä¾¡</strong>ï¼šéåº¦ãªé‡ç”£ã‚’æŠ‘åˆ¶</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> 400å›ç­” â†’ âˆš400 Ã— 3 = 20 Ã— 3 = <strong>60ç‚¹</strong>
            </div>
        </div>

        <!-- 4. ç²¾åº¦ãƒœãƒ¼ãƒŠã‚¹ -->
        <div class="component-card" style="border-left-color: #e74c3c;">
            <div class="component-header">
                <h4><span class="component-label">4</span> ç²¾åº¦ãƒœãƒ¼ãƒŠã‚¹ï¼ˆé«˜æ­£ç­”ç‡ã¸ã®è¿½åŠ è©•ä¾¡ï¼‰</h4>
                <span class="feature-badge" style="background: #e74c3c;">ãƒœãƒ¼ãƒŠã‚¹</span>
            </div>
            <div class="formula-detail">
                <code>95%ä»¥ä¸Š: 150 + (æ­£ç­”ç‡ - 0.95) Ã— 1000</code><br>
                <code>90-94%: 100 + (æ­£ç­”ç‡ - 0.9) Ã— 1000</code><br>
                <code>85-89%: 50 + (æ­£ç­”ç‡ - 0.85) Ã— 1000</code><br>
                <code>80-84%: (æ­£ç­”ç‡ - 0.8) Ã— 1000</code><br>
                <code>80%æœªæº€: 0</code>
            </div>
            <ul class="explanation-list">
                <li><strong>é«˜ç²¾åº¦å ±é…¬</strong>ï¼š80%ä»¥ä¸Šã®æ­£ç­”ç‡ã§ç™ºå‹•</li>
                <li><strong>æ®µéšãƒœãƒ¼ãƒŠã‚¹</strong>ï¼š95%ä»¥ä¸Šã§æœ€å¤§ãƒœãƒ¼ãƒŠã‚¹</li>
                <li><strong>å“è³ªé‡è¦–</strong>ï¼šæ­£ç¢ºæ€§ã¸ã®ç‰¹åˆ¥è©•ä¾¡</li>
            </ul>
            <div class="example-box">
                <strong>ä¾‹ï¼š</strong> æ­£ç­”ç‡92% â†’ 100 + (0.92 - 0.9) Ã— 1000 = 100 + 20 = <strong>120ç‚¹</strong>
            </div>
        </div>
    </div>

    <!-- å…·ä½“ä¾‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="example-section">
        <h3>ğŸ¯ å…·ä½“çš„ãªè¨ˆç®—ä¾‹</h3>
        <div class="calculation-example">
            <div class="example-title">ãƒã‚¹ã‚¿ãƒ¼250å•ã€æ­£è§£850å›/1000å›ç­”ã®å­¦ç¿’è€…ã®å ´åˆ</div>
            <div class="calculation-steps">
                <div class="step">
                    <span class="step-label">1</span>
                    <span class="step-calc">ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚³ã‚¢: floor(250Ã·100)Ã—250 + (50Ã·100)Ã—125 = 500 + 62.5 =
                        <strong>562.5ç‚¹</strong></span>
                </div>
                <div class="step">
                    <span class="step-label">2</span>
                    <span class="step-calc">æ­£ç­”ç‡ã‚¹ã‚³ã‚¢: 350 + (0.85-0.8)Ã—1500 = 350 + 75 = <strong>425ç‚¹</strong></span>
                </div>
                <div class="step">
                    <span class="step-label">3</span>
                    <span class="step-calc">ç¶™ç¶šæ€§ã‚¹ã‚³ã‚¢: âˆš1000 Ã— 3 = 31.6 Ã— 3 = <strong>94.8ç‚¹</strong></span>
                </div>
                <div class="step">
                    <span class="step-label">4</span>
                    <span class="step-calc">ç²¾åº¦ãƒœãƒ¼ãƒŠã‚¹: 50 + (0.85-0.85)Ã—1000 = <strong>50ç‚¹</strong></span>
                </div>
                <div class="final-result">
                    <span class="result-label">ç·åˆã‚¹ã‚³ã‚¢</span>
                    <span class="result-calc">562.5 + 425 + 94.8 + 50 = <strong>1132.3ç‚¹</strong></span>
                </div>
            </div>
        </div>
    </div>

    <!-- è¨­è¨ˆæ€æƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="philosophy-section">
        <h3>âš–ï¸ è¨­è¨ˆæ€æƒ³</h3>
        <div class="philosophy-content">
            <p class="philosophy-main">
                å­¦ç¿’è¡Œå‹•ã«å¿œã˜ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¤‰å‹•ã™ã‚‹å‹•çš„è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚<br>
                æ®µéšçš„è©•ä¾¡ã«ã‚ˆã‚Šæ˜ç¢ºãªç›®æ¨™è¨­å®šã‚’ä¿ƒã—ã€ç¶™ç¶šçš„ãªå­¦ç¿’ã¨é«˜ã„æ­£ç­”ç‡ã‚’ä¸¡ç«‹ã—ã¦è©•ä¾¡
            </p>
            <div class="fairness-features">
                <div class="feature-item">
                    <i class="fas fa-chart-line text-success"></i>
                    <span>100å•ãƒã‚¹ã‚¿ãƒ¼ã”ã¨ã®æ®µéšçš„å¤§å¹…ã‚¹ã‚³ã‚¢ã‚¢ãƒƒãƒ—</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-rocket text-warning"></i>
                    <span>80%ä»¥ä¸Šã®æ­£ç­”ç‡ã§æ€¥æ¿€ãªã‚¹ã‚³ã‚¢ä¸Šæ˜‡</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-award text-primary"></i>
                    <span>é«˜ç²¾åº¦å­¦ç¿’ã«ãƒœãƒ¼ãƒŠã‚¹ä»˜ä¸</span>
                </div>
            </div>
        </div>
    </div>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="back-section">
        <a href="{{ url_for('progress_page') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left"></i> é€²æ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
        </a>
    </div>
</section>

<style>
    .score-details-section {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
    }

    .header-section {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 3px solid #007bff;
    }

    .subtitle {
        color: #6c757d;
        font-size: 1.1rem;
        margin-bottom: 15px;
    }

    .back-link {
        margin-top: 15px;
    }

    .formula-container {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 5px solid #007bff;
    }

    .formula-box {
        text-align: center;
    }

    .formula-main {
        font-size: 1.2rem;
        font-weight: 600;
        color: #2c3e50;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .condition {
        color: #007bff;
    }

    .components-section {
        margin-bottom: 30px;
    }

    .component-card {
        background: white;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-left: 5px solid;
    }

    .mastery-card {
        border-left-color: #28a745;
    }

    .accuracy-card {
        border-left-color: #ffc107;
    }

    .effort-card {
        border-left-color: #17a2b8;
    }

    .component-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .component-label {
        background: #007bff;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-weight: bold;
        margin-right: 10px;
    }

    .weight-badge {
        background: #28a745;
    }

    .feature-badge {
        background: #ffc107;
        color: #000;
    }

    .balance-badge {
        background: #17a2b8;
    }

    .weight-badge,
    .feature-badge,
    .balance-badge {
        color: white;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 500;
    }

    .formula-detail {
        background: #f8f9fa;
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 15px;
        font-family: 'Courier New', monospace;
        border: 1px solid #dee2e6;
    }

    .explanation-list {
        margin-bottom: 15px;
        padding-left: 20px;
    }

    .explanation-list li {
        margin-bottom: 5px;
        color: #495057;
    }

    .example-box {
        background: #e7f3ff;
        padding: 10px 15px;
        border-radius: 6px;
        border: 1px solid #b8daff;
        color: #004085;
    }

    .example-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 30px;
    }

    .calculation-example {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .example-title {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.1rem;
    }

    .calculation-steps {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .step {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 6px;
    }

    .step-label {
        background: #007bff;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-weight: bold;
        min-width: 25px;
        text-align: center;
    }

    .final-result {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        border-radius: 6px;
        font-weight: 600;
        margin-top: 10px;
    }

    .result-label {
        background: rgba(255, 255, 255, 0.2);
        padding: 4px 8px;
        border-radius: 4px;
        min-width: 80px;
        text-align: center;
    }

    .philosophy-section {
        background: linear-gradient(135deg, #6f42c1, #007bff);
        color: white;
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 30px;
    }

    .philosophy-main {
        font-size: 1.1rem;
        line-height: 1.6;
        margin-bottom: 20px;
        text-align: left;
    }

    .fairness-features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
    }

    .feature-item {
        display: flex;
        align-items: center;
        gap: 10px;
        background: rgba(255, 255, 255, 0.1);
        padding: 12px;
        border-radius: 6px;
    }

    .comparison-section {
        margin-bottom: 30px;
    }

    .back-section {
        text-align: center;
        padding-top: 20px;
        border-top: 2px solid #e9ecef;
    }

    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
    @media (max-width: 768px) {
        .score-details-section {
            padding: 15px;
        }

        .component-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .step {
            flex-direction: column;
            align-items: flex-start;
            text-align: left;
        }

        .final-result {
            flex-direction: column;
            align-items: flex-start;
        }

        .fairness-features {
            grid-template-columns: 1fr;
        }

        .formula-main {
            font-size: 1rem;
            line-height: 1.4;
        }
    }
</style>
{% endblock %}